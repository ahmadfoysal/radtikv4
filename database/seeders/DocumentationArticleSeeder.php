<?php

namespace Database\Seeders;

use App\Models\DocumentationArticle;
use Illuminate\Database\Seeder;

class DocumentationArticleSeeder extends Seeder
{
    /**
     * Run the database seeds.
     */
    public function run(): void
    {
        $articles = [
            [
                'title' => 'API Usage Guide',
                'category' => 'api',
                'content' => "RADTik provides a comprehensive API for integration with external systems.\n\nAPI Endpoints:\n\n1. Voucher Management:\n   GET /api/vouchers - List all vouchers\n   POST /api/vouchers - Create new voucher\n   GET /api/vouchers/{id} - Get voucher details\n   PUT /api/vouchers/{id} - Update voucher\n   DELETE /api/vouchers/{id} - Delete voucher\n\n2. Router Management:\n   GET /api/routers - List all routers\n   POST /api/routers - Add new router\n   GET /api/routers/{id} - Get router details\n   PUT /api/routers/{id} - Update router\n   DELETE /api/routers/{id} - Delete router\n\n3. User Management:\n   GET /api/users - List users\n   POST /api/users - Create user\n   GET /api/users/{id} - Get user details\n\nAuthentication:\nAll API requests require authentication using API tokens.\n\nGenerate API Token:\n1. Login to RADTik\n2. Go to Settings → API Keys\n3. Click 'Generate New Token'\n4. Copy the token (shown only once)\n5. Store securely\n\nUsing API Token:\nInclude token in request header:\nAuthorization: Bearer YOUR_API_TOKEN\n\nExample Request (cURL):\ncurl -X GET https://your-radtik.com/api/vouchers \\\n  -H 'Authorization: Bearer YOUR_API_TOKEN' \\\n  -H 'Accept: application/json'\n\nExample Response:\n{\n  \"status\": \"success\",\n  \"data\": [\n    {\n      \"id\": 1,\n      \"username\": \"VOUCHER123\",\n      \"status\": \"active\",\n      \"created_at\": \"2024-01-01T00:00:00.000000Z\"\n    }\n  ]\n}\n\nRate Limiting:\n- 60 requests per minute per IP\n- 1000 requests per hour per token\n- Exceeding limits returns 429 status code\n\nError Handling:\nAPI uses standard HTTP status codes:\n- 200: Success\n- 201: Created\n- 400: Bad Request\n- 401: Unauthorized\n- 403: Forbidden\n- 404: Not Found\n- 422: Validation Error\n- 429: Too Many Requests\n- 500: Server Error\n\nError Response Format:\n{\n  \"status\": \"error\",\n  \"message\": \"Error description\",\n  \"errors\": {\n    \"field\": [\"Validation error message\"]\n  }\n}\n\nBest Practices:\n- Store API tokens securely\n- Use HTTPS for all requests\n- Implement retry logic for failed requests\n- Handle rate limiting gracefully\n- Validate responses before processing\n- Log API interactions for debugging\n- Rotate API tokens periodically",
                'is_active' => true,
            ],
            [
                'title' => 'MikroTik API Integration',
                'category' => 'integration',
                'content' => "RADTik integrates with MikroTik routers using the MikroTik API for seamless management.\n\nSystem Requirements:\n- MikroTik RouterOS 6.x or 7.x\n- API service enabled\n- User with API permissions\n- Network connectivity between RADTik and router\n\nEnabling MikroTik API:\n1. Connect to router via Winbox or SSH\n2. Navigate to IP → Services\n3. Enable 'api' service\n4. Set port (default: 8728)\n5. Configure firewall to allow connections\n\nAPI Port Configuration:\nDefault API port: 8728\nDefault API-SSL port: 8729 (recommended for production)\n\nCreating API User:\n1. Go to System → Users\n2. Add new user\n3. Set username and password\n4. Assign group 'full' or 'api' permissions\n5. Set allowed address if needed\n\nFirewall Configuration:\nAdd firewall rule to allow API access:\n/ip firewall filter add chain=input protocol=tcp \\\n  dst-port=8728 src-address=YOUR_RADTIK_IP \\\n  action=accept comment=\"RADTik API Access\"\n\nRADTik Connection:\nWhen adding router in RADTik:\n- IP Address: Router's IP address\n- API Port: 8728 (or custom)\n- Username: API user\n- Password: API user password\n- SSL: Enable for encrypted connection\n\nAvailable API Functions:\n\n1. User Management:\n   - Create hotspot user\n   - Update user profile\n   - Delete user\n   - List all users\n   - Get active sessions\n\n2. Profile Management:\n   - Pull profiles from router\n   - Sync profile changes\n   - Update rate limits\n\n3. Session Management:\n   - Get active sessions\n   - Disconnect user\n   - View session statistics\n\n4. System Information:\n   - Router status\n   - Resource usage\n   - Interface statistics\n\nAPI Synchronization:\nRADTik can sync with MikroTik:\n- Pull active users from router\n- Push new users to router\n- Sync profile changes\n- Clean up orphaned users\n\nScheduled Sync:\nSet up automatic sync using MikroTik scheduler:\n1. Create script in router\n2. Schedule to run every 5-30 minutes\n3. Script calls RADTik sync endpoint\n4. Keeps systems synchronized\n\nExample Sync Script:\n/tool fetch url=\"https://your-radtik.com/mikrotik/api/pull-active-users?router_id=1&token=YOUR_TOKEN\" mode=https\n\nTroubleshooting:\n- Check API service is running\n- Verify firewall rules\n- Test connectivity with ping\n- Check user permissions\n- Review API logs in RADTik\n- Enable debug logging if needed\n\nSecurity Best Practices:\n- Use SSL/TLS for API connections\n- Restrict API access by IP\n- Use strong passwords\n- Limit user permissions\n- Monitor API access logs\n- Update RouterOS regularly\n- Disable unused services",
                'is_active' => true,
            ],
            [
                'title' => 'RADIUS Server Setup',
                'category' => 'radius',
                'content' => "RADTik includes built-in RADIUS server functionality for hotspot authentication.\n\nWhat is RADIUS?\nRADIUS (Remote Authentication Dial-In User Service) is a protocol for centralized authentication, authorization, and accounting (AAA).\n\nRADTik RADIUS Features:\n- Built-in RADIUS server\n- No external RADIUS software needed\n- Direct database integration\n- Real-time user management\n- Session tracking\n- Bandwidth accounting\n\nRADIUS Server Configuration:\n\n1. Enable RADIUS in RADTik:\n   - Go to Admin Settings → RADIUS Server\n   - Enable RADIUS service\n   - Set listening IP and port (default: 1812)\n   - Configure shared secret\n   - Save settings\n\n2. RADIUS Attributes:\n   RADTik supports standard RADIUS attributes:\n   - User-Name\n   - User-Password\n   - NAS-IP-Address\n   - NAS-Port\n   - Service-Type\n   - Framed-IP-Address\n   - Acct-Session-Id\n   - Acct-Input-Octets\n   - Acct-Output-Octets\n\n3. Accounting:\n   RADIUS accounting tracks:\n   - Session start/stop time\n   - Data usage (upload/download)\n   - Session duration\n   - User IP address\n   - MAC address\n\nConfiguring MikroTik with RADTik RADIUS:\n\n1. Add RADIUS Server:\n   /radius add service=hotspot,login \\\n     address=YOUR_RADTIK_IP \\\n     secret=YOUR_SHARED_SECRET \\\n     timeout=3000ms\n\n2. Enable RADIUS in Hotspot:\n   /ip hotspot profile set [find] \\\n     use-radius=yes\n\n3. Configure Accounting:\n   /radius add service=hotspot-accounting \\\n     address=YOUR_RADTIK_IP \\\n     secret=YOUR_SHARED_SECRET \\\n     timeout=3000ms\n\n4. Test RADIUS:\n   /radius monitor [find]\n\nRADIUS vs MikroTik Mode:\n\nMikroTik Mode:\n- Users stored in MikroTik\n- Limited by router resources\n- Slower with many users\n- No central management\n\nRADIUS Mode:\n- Users stored in RADTik database\n- Unlimited scalability\n- Fast authentication\n- Central management\n- Multiple routers share database\n\nRADIUS Profiles:\nCreate profiles in RADTik:\n1. Navigate to Profiles\n2. Add RADIUS profile\n3. Set bandwidth limits:\n   - Upload rate limit\n   - Download rate limit\n   - Burst threshold\n   - Burst time\n\n4. Configure session settings:\n   - Session timeout\n   - Idle timeout\n   - MAC cookie timeout\n\n5. Save profile\n\nRADIUS Authentication Flow:\n1. User connects to hotspot\n2. Router sends auth request to RADTik\n3. RADTik validates credentials\n4. Returns profile attributes if valid\n5. Router applies profile settings\n6. User gets internet access\n\nRADIUS Accounting Flow:\n1. Session starts → Accounting-Start\n2. Periodic updates → Interim-Update\n3. Session ends → Accounting-Stop\n4. Data stored in RADTik database\n\nMonitoring RADIUS:\n- View active sessions\n- Check authentication logs\n- Monitor accounting data\n- Generate usage reports\n- Track session statistics\n\nTroubleshooting:\n- Check RADIUS service is running\n- Verify shared secret matches\n- Test network connectivity\n- Review RADIUS logs\n- Check user credentials\n- Verify profile configuration\n- Test with radtest command\n\nSecurity Considerations:\n- Use strong shared secret\n- Limit RADIUS access by IP\n- Enable connection encryption\n- Regular security audits\n- Monitor authentication attempts\n- Implement rate limiting",
                'is_active' => true,
            ],
            [
                'title' => 'Billing System Overview',
                'category' => 'billing',
                'content' => "RADTik includes a comprehensive billing system for managing subscriptions and payments.\n\nBilling Components:\n\n1. Packages:\n   - Define subscription plans\n   - Set user limits\n   - Configure pricing\n   - Choose billing cycle\n\n2. Invoices:\n   - Automatic generation\n   - PDF export\n   - Email notifications\n   - Payment tracking\n\n3. Account Balance:\n   - User wallet system\n   - Top-up functionality\n   - Transaction history\n   - Balance notifications\n\n4. Payment Gateways:\n   - Multiple payment methods\n   - Cryptomus integration\n   - PayStation integration\n   - Manual payments\n\nBilling Workflow:\n\n1. Package Assignment:\n   - Admin assigns package to router\n   - Set start and end date\n   - Enable auto-renewal option\n   - Invoice generated automatically\n\n2. Payment Processing:\n   - User receives invoice notification\n   - Chooses payment method\n   - Completes payment\n   - Balance updated\n   - Invoice marked as paid\n\n3. Renewal Process:\n   - System checks expiring packages\n   - If auto-renew enabled:\n     a. Check account balance\n     b. Deduct renewal amount\n     c. Extend package validity\n     d. Generate new invoice\n     e. Send confirmation email\n   - If auto-renew disabled:\n     a. Send expiration warning\n     b. Service expires on due date\n     c. Manual renewal required\n\nInvoice Management:\n\nInvoice States:\n- Draft: Created but not finalized\n- Pending: Awaiting payment\n- Paid: Payment received\n- Cancelled: Invoice cancelled\n- Refunded: Payment refunded\n\nInvoice Details:\n- Invoice number (auto-generated)\n- Date issued\n- Due date\n- Items (package, quantity, price)\n- Subtotal\n- Tax (if applicable)\n- Total amount\n- Payment status\n\nPayment Gateway Integration:\n\n1. Cryptomus (Cryptocurrency):\n   - Supports multiple cryptocurrencies\n   - Real-time exchange rates\n   - Instant confirmations\n   - Webhook notifications\n\n2. PayStation:\n   - Credit/debit cards\n   - Digital wallets\n   - Bank transfers\n   - Mobile payments\n\nConfiguring Payment Gateways:\n1. Go to Admin → Payment Gateways\n2. Select gateway to configure\n3. Enter API credentials:\n   - Merchant ID\n   - API Key\n   - Secret Key\n4. Set test/production mode\n5. Configure webhook URL\n6. Save configuration\n\nManual Payment Processing:\nFor offline payments:\n1. Go to Billing → Manual Adjustment\n2. Select user\n3. Enter payment amount\n4. Add reference/description\n5. Select payment method\n6. Create transaction\n7. Update invoice status\n\nTransaction History:\nTrack all financial transactions:\n- Payment receipts\n- Balance additions\n- Deductions\n- Refunds\n- Adjustments\n\nReporting:\nGenerate reports for:\n- Revenue summary\n- Payment statistics\n- Outstanding invoices\n- Renewal forecast\n- User balance summary\n- Transaction log\n\nAutomated Notifications:\nSystem sends emails for:\n- New invoice created\n- Payment received\n- Payment failed\n- Invoice due reminder\n- Package expiring soon\n- Auto-renewal success/failure\n- Balance low warning\n\nBest Practices:\n- Enable auto-renewal for convenience\n- Maintain sufficient balance\n- Review invoices promptly\n- Keep payment info updated\n- Monitor transaction history\n- Set up payment reminders\n- Regular financial audits",
                'is_active' => true,
            ],
            [
                'title' => 'Admin vs Reseller Permissions',
                'category' => 'permissions',
                'content' => "RADTik implements role-based access control with three main user types: Superadmin, Admin, and Reseller.\n\nUser Roles Overview:\n\n1. Superadmin:\n   - Full system access\n   - Manage all users and routers\n   - Configure system settings\n   - Manage payment gateways\n   - Access all billing features\n   - View system logs\n   - Manage packages and zones\n\n2. Admin:\n   - Manage own routers\n   - Create and manage resellers\n   - Generate vouchers\n   - Manage profiles\n   - Assign routers to resellers\n   - Access billing features\n   - View reports\n\n3. Reseller:\n   - Access assigned routers only\n   - Generate vouchers\n   - View assigned router statistics\n   - Access limited reports\n   - Manage own profile\n   - Cannot add new routers\n   - Cannot manage other users\n\nPermission Matrix:\n\nRouter Management:\n- Add Router: Superadmin, Admin\n- Edit Router: Superadmin, Admin (own routers)\n- Delete Router: Superadmin, Admin (own routers)\n- View Router: Superadmin, Admin, Reseller (assigned)\n- Assign to Reseller: Superadmin, Admin\n\nVoucher Management:\n- Generate Vouchers: All roles\n- View Vouchers: All roles (scoped to access)\n- Edit Vouchers: Superadmin, Admin\n- Delete Vouchers: Superadmin, Admin\n- Print Vouchers: All roles\n\nUser Management:\n- Create User: Superadmin, Admin\n- Edit User: Superadmin, Admin (own resellers)\n- Delete User: Superadmin, Admin (own resellers)\n- View Users: Superadmin, Admin\n- Assign Role: Superadmin\n\nProfile Management:\n- Create Profile: Superadmin, Admin\n- Edit Profile: Superadmin, Admin\n- Delete Profile: Superadmin, Admin\n- View Profile: All roles\n\nBilling:\n- View Invoices: All roles (own invoices)\n- Create Invoice: Superadmin, Admin\n- Manual Adjustment: Superadmin\n- Add Balance: All roles (own account)\n- Configure Gateways: Superadmin\n\nSettings:\n- System Settings: Superadmin\n- Payment Gateways: Superadmin\n- Zone Management: Superadmin, Admin\n- API Keys: All roles (own keys)\n- Email Settings: Superadmin\n\nReports:\n- Sales Reports: Superadmin, Admin\n- Usage Reports: All roles (scoped)\n- System Logs: Superadmin\n- Voucher Logs: All roles (scoped)\n\nReseller Workflow:\n\n1. Admin Creates Reseller:\n   - Navigate to Users → Add User\n   - Fill in user details\n   - Assign role: Reseller\n   - Set initial balance\n   - Save user\n\n2. Assign Routers:\n   - Go to Resellers → Assign Router\n   - Select reseller\n   - Choose routers to assign\n   - Set permissions\n   - Save assignment\n\n3. Reseller Access:\n   - Login with credentials\n   - View assigned routers only\n   - Generate vouchers\n   - Check statistics\n   - Manage own profile\n\nPermission Features:\n\n1. Router Isolation:\n   - Resellers see only assigned routers\n   - Cannot access other resellers' data\n   - Scoped reporting\n\n2. Data Segregation:\n   - Vouchers scoped to user's routers\n   - Reports filtered by access\n   - Profiles shared across users\n\n3. Audit Trail:\n   - Track user actions\n   - Monitor data access\n   - Log permission changes\n\nBest Practices:\n- Assign minimal required permissions\n- Regular permission audits\n- Document role assignments\n- Train users on their access level\n- Monitor suspicious activities\n- Use strong passwords\n- Enable two-factor authentication\n- Regular security reviews",
                'is_active' => true,
            ],
            [
                'title' => 'Voucher Generation and Management',
                'category' => 'vouchers',
                'content' => "Complete guide to generating and managing vouchers in RADTik.\n\nVoucher Generation:\n\n1. Access Generation Page:\n   - Navigate to Vouchers → Generate Voucher\n   - Or use quick action from dashboard\n\n2. Select Mode:\n   - MikroTik Hotspot: Direct router integration\n   - RADIUS Server: Centralized authentication\n\n3. Configure Generation:\n   - Router: Select target router\n   - Profile: Choose bandwidth profile\n   - Quantity: Number of vouchers (1-5000)\n   - Length: Code length (6-12 characters)\n   - Prefix: Optional prefix (e.g., 'WF-')\n   - Serial Start: Optional serial numbering\n   - Character Type: Numeric, letters, alphanumeric\n\n4. Generate:\n   - Click 'Generate Vouchers'\n   - Wait for processing\n   - View generated codes\n\nVoucher Properties:\n\nStates:\n- Inactive: Generated but not used\n- Active: Currently in use\n- Expired: Time limit reached\n- Disabled: Manually disabled\n\nFields:\n- Username: Login credential\n- Password: Authentication password\n- Profile: Bandwidth profile\n- Batch: Generation batch ID\n- Status: Current state\n- Router: Associated router\n- Created by: User who generated\n- Activated at: First use timestamp\n- Expires at: Expiration timestamp\n\nBatch Management:\n\nBatch ID Format: B{date}{random}\nExample: B250109AXYZ\n\nBatch Operations:\n- View vouchers by batch\n- Print entire batch\n- Export batch to CSV\n- Delete batch\n- Track batch statistics\n\nVoucher Activation:\n\n1. User connects to hotspot\n2. Opens browser → redirects to login\n3. Enters voucher code\n4. System validates:\n   - Code exists\n   - Not expired\n   - Not already active\n   - Profile available\n5. Creates session\n6. Applies bandwidth limits\n7. Tracks usage\n\nVoucher Management:\n\n1. Search Vouchers:\n   - By username\n   - By batch ID\n   - By status\n   - By router\n   - By date range\n\n2. Filter Options:\n   - Status filter\n   - Router filter\n   - Channel filter (MikroTik/RADIUS)\n   - Creator filter\n\n3. Actions:\n   - View details\n   - Edit properties\n   - Disable/Enable\n   - Delete\n   - Print single\n   - Export data\n\nBulk Operations:\n\n1. Bulk Print:\n   - Select vouchers\n   - Choose template\n   - Print batch\n\n2. Bulk Delete:\n   - Filter by criteria\n   - Select vouchers\n   - Confirm deletion\n\n3. Bulk Export:\n   - CSV format\n   - Excel format\n   - PDF list\n\nPrinting Options:\n\nTemplates:\n- Template 1: Standard layout\n- Template 2: Compact design\n- Template 3: Detailed info\n- Template 4: QR code included\n- Template 5: Custom branding\n\nCustomization:\n- Logo placement\n- Color scheme\n- Text content\n- Layout format\n- Paper size\n\nTracking and Monitoring:\n\nVoucher Statistics:\n- Total generated\n- Active count\n- Expired count\n- Inactive count\n- Usage percentage\n\nSession Information:\n- Start time\n- Duration\n- Data uploaded\n- Data downloaded\n- Total data used\n- IP address\n- MAC address\n\nVoucher Logs:\nTrack events:\n- Generation\n- Activation\n- Expiration\n- Deletion\n- Status changes\n- Session starts/stops\n\nBest Practices:\n- Use meaningful prefixes\n- Generate in appropriate batches\n- Regular cleanup of expired\n- Monitor usage patterns\n- Secure voucher distribution\n- Keep generation records\n- Use appropriate code length\n- Choose suitable profiles",
                'is_active' => true,
            ],
        ];

        foreach ($articles as $article) {
            DocumentationArticle::create($article);
        }
    }
}
